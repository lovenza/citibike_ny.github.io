---
title: "The Pulse of the City: NYC Citi Bike Ridership Analysis"
subtitle: "Understanding Urban Mobility Through Weather and Temporal Patterns"
author: "Mungyu Kwok, Ziang Niu, Bowen Xia, Zihan Zhou"
date: "December 2025"
output: 
  html_document:
    toc: true
    toc_float: 
      collapsed: false
      smooth_scroll: true
    toc_depth: 3
    code_folding: hide
    theme: cosmo
    highlight: tango
    css: styles.css
    includes:
      after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  fig.width = 10,
  fig.height = 6
)

library(tidyverse)
library(knitr)
library(kableExtra)
```

<a href="index.html" class="back-home">
  <i class="fa fa-home"></i> Back to Home
</a>

<div class="hero-section">
  <h1>ðŸ“Š Final Project Report</h1>
  <p><strong>Analyzing NYC Citi Bike Ridership Patterns in Response to Daily Rhythms and Weather</strong></p>
  <p>Columbia University Mailman School of Public Health | Data Science I (P8105) | Fall 2025</p>
</div>

<br>

---

# Motivation

<div class="info-card">

Citi Bike has become an integral part of New York City's public transportation network since its launch in 2013, serving millions of rides annually to commuters, residents, and tourists. As one of the largest bike-share systems in North America, it generates a wealth of trip-level data that provides a unique window into urban mobility patterns in one of the world's most dynamic cities.

Understanding how people use Citi Bikeâ€”and what factors influence their decisions to rideâ€”has important implications across multiple domains:

**Urban Planning & Infrastructure:** Identifying peak usage times and popular routes helps city planners optimize bike lane placement, station locations, and dock capacity. This data-driven approach to infrastructure investment can improve safety, reduce congestion, and make cycling a more attractive transportation option.

**Public Health:** Active transportation like cycling contributes to physical activity levels and can help address chronic disease prevention. Understanding usage patterns among different user groups can inform public health interventions and promote active commuting.

**Environmental Sustainability:** Bike-sharing reduces car trips and associated greenhouse gas emissions. Quantifying weather's impact on ridership helps us understand barriers to sustainable transportation adoption and design interventions to encourage year-round cycling.

**Operational Efficiency:** For Citi Bike operators, understanding demand patterns is crucial for bike redistribution, maintenance scheduling, and capacity planning. Predictive models based on weather and temporal factors can optimize operations and improve user experience.

**Academic Interest:** This project applies statistical methods learned in P8105 (Data Science I) to a rich, real-world dataset. It demonstrates the practical application of data wrangling, visualization, exploratory analysis, and statistical modeling techniques to answer meaningful research questions.

Our analysis focuses on three core research questions:

1. **Temporal Patterns:** How do predictable daily and weekly rhythms (time of day, weekday vs. weekend) shape ridership? When are the commuter peaks? How do weekends differ?

2. **User Segmentation:** How do different user groups (annual members vs. casual riders) use the system differently in terms of trip volume, duration, and timing? 

3. **Weather Impact:** To what extent does daily weatherâ€”temperature and precipitationâ€”influence the decision to ride a bike? Can we quantify these effects?

By combining granular trip-level data with daily weather records, we aim to paint a comprehensive picture of the factors that drive urban cycling behavior in New York City.

</div>

---

# Related Work

<div class="info-card">

This project draws inspiration from several sources:

**Course Materials:** The project builds directly on concepts and techniques covered in P8105 (Data Science I), including:
- Data wrangling with `tidyverse` (Lectures 3-4)
- Visualization with `ggplot2` (Lectures 5-6)  
- Exploratory data analysis techniques (Lectures 7-8)
- Linear regression and statistical modeling (Lectures 10-11)
- Interactive visualization with Shiny (Lecture on building dashboards)
- Website creation with R Markdown (Lecture on project organization)

**Academic Research:** Previous studies have examined bike-share usage patterns in various cities, often finding strong effects of weather (especially precipitation and extreme temperatures) and time-of-day peaks corresponding to commute hours. These studies informed our hypotheses and analytical approach.

**Citi Bike System Data:** The official Citi Bike System Data published monthly by Lyft provides the foundation for our analysis. The comprehensive trip-level data, updated regularly, enables reproducible research on urban mobility patterns.

**NYC Open Data & NOAA:** Integration with weather data from NOAA's Global Historical Climatology Network demonstrates the value of combining multiple public datasets to answer complex research questions.

**Past P8105 Projects:** We reviewed exemplary final projects from previous years, including:
- Inflammatory Indices analysis (https://danglin1214.github.io/Inflammatory_Indices.github.io/)
- NYC Air Quality project (https://joielizeqi.github.io/p8105_final.github.io/)  
- NYC Gardens project (https://kd2942.github.io/nycgardens.github.io/)

These projects provided valuable examples of effective data presentation, visualization strategies, and website organization.

**Visualization Inspiration:** Best practices from data visualization literature (Tufte, Few, Cairo) guided our chart design choices, with emphasis on clarity, appropriate chart types, and avoiding chartjunk.

</div>

---

# Initial Questions & Evolution

<div class="info-card">

## Initial Research Questions

At the project's inception (November 2025), we formulated three primary research questions:

1. **How do predictable daily and weekly rhythms (time of day, weekday vs. weekend) shape ridership?**
   - When are the peak usage hours?
   - Do weekends show different patterns than weekdays?
   - Are there distinct commuter peaks?

2. **How do members and casual riders differ in their usage patterns?**
   - Do they ride at different times of day?
   - Do they have different trip durations?
   - Which stations do they prefer?

3. **How does weather influence ridership volume?**
   - What's the effect of temperature on daily rides?
   - How does precipitation affect ridership?
   - Can we build predictive models?

## Questions That Evolved

As we dove into the data, several questions evolved or emerged:

**Refined Temporal Analysis:**
- We discovered strong commuter patterns with distinct morning (7-9 AM) and evening (5-7 PM) peaks, leading us to focus more on weekday vs. weekend comparisons
- Weekend patterns revealed more recreational usage spread throughout midday hours
- We added analysis of holiday effects when we noticed September data included Labor Day

**User Behavior Deep Dives:**
- Initial analysis showed members had shorter, more utilitarian trips while casual riders took longer leisure trips
- This led us to examine bike type preferences (classic vs. electric) across user groups
- We explored geographic differences: members dominated in outer boroughs while casual riders concentrated in tourist areas

**Weather Effects:**
- We initially planned simple correlations but expanded to multiple regression models
- We separated models by user type (member vs. casual) when we discovered different weather sensitivities
- We added precipitation as a key variable after seeing its dramatic effect on ridership
- We incorporated day-of-week effects into regression models after EDA revealed their importance

**Spatial Patterns:**
- We added geospatial analysis to identify popular stations and routes
- Created interactive maps to explore station-level patterns
- Examined borough-level differences in usage

## New Questions Considered

During the course of analysis, we considered several additional questions:

**Bike Type Analysis:**
- How do electric bikes vs. classic bikes affect trip duration and distance?
- Do certain user types prefer electric bikes?

**Station Capacity:**
- Are popular stations showing signs of capacity constraints?
- Should Citi Bike expand certain stations?

**Predictive Modeling:**
- Can we build models to predict daily ridership based on weather forecasts?
- What's the practical accuracy for operational planning?

**Time Series Analysis:**
- Are there longer-term trends across September?
- How do ridership patterns change throughout the month?

While we touched on many of these questions in our exploratory analysis, we maintained focus on our three core research questions to ensure depth over breadth. Future work could expand on these emerging areas of interest.

</div>

---

# Data

<div class="info-card">

## Data Sources

Our analysis combines two primary datasets:

### 1. Citi Bike System Data (September 2025)

**Source:** Official Citi Bike trip data published by Lyft  
**URL:** https://s3.amazonaws.com/tripdata/index.html  
**Original Size:** ~3 million rides in September 2025  
**Coverage:** All Citi Bike trips in NYC service area

**Variables:**
- `ride_id`: Unique identifier for each trip
- `rideable_type`: Bike type (classic_bike, electric_bike)
- `started_at`, `ended_at`: Trip start/end timestamps
- `start_station_name`, `end_station_name`: Station names
- `start_station_id`, `end_station_id`: Station IDs
- `start_lat`, `start_lng`, `end_lat`, `end_lng`: GPS coordinates
- `member_casual`: User type (member = annual subscriber, casual = day pass or single ride)

### 2. NOAA Weather Data (September 2025)

**Source:** NOAA Global Historical Climatology Network  
**Station:** Central Park (USW00094728)  
**URL:** https://www.ncdc.noaa.gov/cdo-web/  
**Coverage:** Daily weather observations for NYC

**Variables:**
- `date`: Observation date
- `tmax`: Maximum temperature (Â°F)
- `tmin`: Minimum temperature (Â°F)
- `prcp`: Precipitation (inches)
- `snow`: Snowfall (inches, not applicable for September)

## Data Collection & Sampling

### Stratified Sampling Strategy

Given computational constraints and the pedagogical focus of this course, we implemented a **proportional stratified sampling** approach:

**Rationale:** September 2025 had approximately 3 million rides. To create a manageable dataset for analysis while preserving the statistical properties of the full population, we:

1. **Grouped by date:** Calculated daily ride counts for all 30 days in September
2. **Computed proportions:** Determined each day's proportion of total monthly rides
3. **Sampled proportionally:** Drew 100,000 total rides, with each day contributing its proportional share

**Statistical Justification:**
- This approach ensures our sample reflects the true temporal distribution
- Preserves relationships between ridership and day-of-week
- Maintains weather-ridership correlations
- Enables valid inference to the full September population
- Sample size (n=100,000) provides sufficient power for regression analyses

**Code Implementation:**
```r
# Calculate daily proportions
daily_proportions <- full_data %>%
  count(date) %>%
  mutate(proportion = n / sum(n))

# Sample proportionally from each day
sampled_data <- full_data %>%
  group_by(date) %>%
  slice_sample(prop = daily_proportions$proportion[cur_group_id()]) %>%
  ungroup()
```

### Data Download Process

**Citi Bike Data:**
```r
# Download September 2025 data
url <- "https://s3.amazonaws.com/tripdata/202509-citibike-tripdata.csv.zip"
download.file(url, "citibike_sept_2025.zip")
unzip("citibike_sept_2025.zip")
bike_data <- read_csv("202509-citibike-tripdata.csv")
```

**Weather Data:**
```r
# Download from NOAA using rnoaa package
library(rnoaa)
weather_data <- ncdc(
  datasetid = "GHCND",
  stationid = "GHCND:USW00094728",  # Central Park
  startdate = "2025-09-01",
  enddate = "2025-09-30",
  datatypeid = c("TMAX", "TMIN", "PRCP"),
  limit = 1000
)
```

## Data Cleaning

### Citi Bike Data Cleaning

**1. Timestamp Parsing:**
```r
bike_data_clean <- bike_data %>%
  mutate(
    started_at = ymd_hms(started_at),
    ended_at = ymd_hms(ended_at),
    start_date = as.Date(started_at)
  )
```

**2. Temporal Variable Creation:**
```r
bike_data_clean <- bike_data_clean %>%
  mutate(
    hour = hour(started_at),
    day_of_week = wday(started_at, label = TRUE),
    is_weekend = day_of_week %in% c("Sat", "Sun"),
    month = month(started_at),
    day = day(started_at)
  )
```

**3. Duration Calculation:**
```r
bike_data_clean <- bike_data_clean %>%
  mutate(
    ride_duration_min = as.numeric(difftime(ended_at, started_at, units = "mins"))
  )
```

**4. Distance Calculation (Haversine Formula):**
```r
# Calculate straight-line distance between start and end points
bike_data_clean <- bike_data_clean %>%
  mutate(
    distance_km = {
      R <- 6371  # Earth radius in km
      lat1 <- start_lat * pi / 180
      lat2 <- end_lat * pi / 180
      dlat <- (end_lat - start_lat) * pi / 180
      dlon <- (end_lng - start_lng) * pi / 180
      
      a <- sin(dlat/2)^2 + cos(lat1) * cos(lat2) * sin(dlon/2)^2
      c <- 2 * atan2(sqrt(a), sqrt(1-a))
      R * c
    }
  )
```

**5. Outlier Removal:**
```r
bike_data_clean <- bike_data_clean %>%
  filter(
    ride_duration_min > 0,           # Remove negative/zero durations
    ride_duration_min < 120,         # Remove extremely long trips (>2 hours)
    distance_km > 0,                 # Remove zero-distance trips
    distance_km < 50,                # Remove unrealistic distances
    !is.na(start_station_name),      # Remove trips without station info
    !is.na(end_station_name)
  )
```

**6. Factor Encoding:**
```r
bike_data_clean <- bike_data_clean %>%
  mutate(
    member_casual = factor(member_casual, levels = c("member", "casual")),
    rideable_type = factor(rideable_type)
  )
```

### Weather Data Cleaning

**1. Temperature Conversion:**
```r
weather_clean <- weather_data %>%
  mutate(
    tmax = (tmax / 10) * 9/5 + 32,  # Convert from tenths of Â°C to Â°F
    tmin = (tmin / 10) * 9/5 + 32,
    prcp = prcp / 254                # Convert from tenths of mm to inches
  )
```

**2. Missing Value Handling:**
```r
# Check for missing values
weather_clean %>%
  summarize(
    missing_tmax = sum(is.na(tmax)),
    missing_tmin = sum(is.na(tmin)),
    missing_prcp = sum(is.na(prcp))
  )

# Impute missing precipitation as 0 (no rain)
weather_clean <- weather_clean %>%
  mutate(prcp = replace_na(prcp, 0))
```

### Data Merging

**Join bike trips with weather data:**
```r
# Aggregate bike data to daily level for weather analysis
daily_rides <- bike_data_clean %>%
  group_by(start_date, member_casual) %>%
  summarize(
    total_rides = n(),
    avg_duration = mean(ride_duration_min),
    avg_distance = mean(distance_km)
  )

# Merge with weather
analysis_data <- daily_rides %>%
  left_join(weather_clean, by = c("start_date" = "date"))
```

## Data Quality Checks

**Final Dataset Characteristics:**

```r
# Summary statistics
summary_stats <- bike_data_clean %>%
  summarize(
    total_rides = n(),
    date_range = paste(min(start_date), "to", max(start_date)),
    avg_duration = mean(ride_duration_min),
    avg_distance = mean(distance_km),
    pct_member = mean(member_casual == "member") * 100,
    unique_start_stations = n_distinct(start_station_name),
    unique_end_stations = n_distinct(end_station_name)
  )
```

**Data Completeness:**
- 100% of trips have valid timestamps
- 99.5% have station names (0.5% filtered as missing)
- 100% have user type classification
- 100% have geographic coordinates
- Weather data: Complete for all 30 days

**Validation Checks:**
- All durations between 0 and 120 minutes âœ“
- All distances between 0 and 50 km âœ“
- All dates within September 2025 âœ“
- Member/casual classifications valid âœ“
- Temperature values reasonable for September in NYC (50-85Â°F) âœ“

## Final Dataset Structure

**Trip-Level Data (bike_data_light.csv):**
- **Rows:** 100,000 trips
- **Columns:** 24 variables
- **Size:** ~31 MB
- **Key Variables:** timestamps, stations, user type, duration, distance, weather (merged)

**Daily Aggregated Data:**
- **Rows:** 30 days Ã— 2 user types = 60 observations
- **Columns:** 8 variables  
- **Used For:** Regression modeling of daily ridership

This clean, well-structured dataset forms the foundation for all subsequent exploratory analyses and statistical modeling described in the following sections.

</div>

---

# Exploratory Analysis

<div class="info-card">

Our exploratory data analysis (EDA) systematically investigated the three core research questions through visualization and summary statistics. This section documents the major findings and insights that emerged.

## Temporal Patterns

### Hourly Usage Patterns

**Research Question:** When do people ride Citi Bikes? How do patterns differ between weekdays and weekends?

**Key Findings:**

1. **Clear Commuter Peaks on Weekdays:**
   - Morning peak: 7-9 AM (especially 8 AM)
   - Evening peak: 5-7 PM (peak at 6 PM)
   - These align with typical NYC commute times
   - Midday (12-2 PM) shows moderate "lunch hour" activity

2. **Weekend Recreational Pattern:**
   - No sharp commuter peaks
   - Gradual rise from 10 AM to peak around 2-4 PM
   - More spread-out usage throughout daylight hours
   - Suggests leisure/recreational trips rather than commuting

**Visualization:**
```r
# Hourly pattern by weekend/weekday
hourly_pattern <- bike_data_clean %>%
  mutate(day_type = ifelse(is_weekend, "Weekend", "Weekday")) %>%
  count(hour, day_type)

ggplot(hourly_pattern, aes(x = hour, y = n, color = day_type)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  scale_x_continuous(breaks = 0:23) +
  scale_y_continuous(labels = scales::comma) +
  labs(
    title = "Hourly Ridership Patterns: Weekday vs Weekend",
    x = "Hour of Day",
    y = "Number of Rides",
    color = "Day Type"
  ) +
  theme_minimal()
```

### Day-of-Week Patterns

**Key Findings:**

1. **Weekday Consistency:**
   - Tuesday-Thursday show highest ridership
   - Monday slightly lower (post-weekend effect)
   - Friday drops off (early weekend departures)

2. **Weekend Drop:**
   - Saturday and Sunday show 20-30% lower total ridership
   - Despite longer individual trip duration
   - Reflects the system's primary role in commuting

### Monthly Trends

**Key Findings:**

1. **Weather-Driven Variation:**
   - Early September (Labor Day weekend): High recreational use
   - Mid-month peaks coincide with warm, dry weather
   - Late September decline as temperatures cool

2. **No Strong Day-of-Month Effects:**
   - No obvious pay-cycle or monthly patterns
   - Variability mostly explained by weather and day-of-week

## User Segmentation Analysis

### Members vs. Casual Riders: Volume

**Key Findings:**

1. **Members Dominate Overall:**
   - 75% of all rides are by members
   - 25% by casual riders
   - Reflects the system's strong commuter base

2. **Different Time Patterns:**
   - **Members:** Strong weekday peaks (commuting)
   - **Casual:** More weekend/midday usage (recreation)

### Trip Duration Differences

**Key Findings:**

1. **Casual Riders Take Longer Trips:**
   - Casual: Average 15-18 minutes
   - Members: Average 10-12 minutes
   - Casual trips 40-50% longer on average

2. **Members Are More Utilitarian:**
   - Shorter, more direct trips
   - Consistent duration across days/times
   - Suggests goal-oriented commuting behavior

3. **Casual Riders Are More Exploratory:**
   - Longer, more variable durations
   - Peak durations on weekends
   - Suggests leisure/sightseeing trips

### Bike Type Preferences

**Key Findings:**

1. **Electric Bike Adoption:**
   - Electric bikes: 45% of rides
   - Classic bikes: 55% of rides
   - Growing preference for electric, especially in hilly areas

2. **User Type Differences:**
   - Members: Slight preference for classic bikes (58%)
   - Casual: Stronger preference for electric bikes (52%)
   - May reflect trip purpose (commute vs. leisure)

### Geographic Patterns

**Key Findings:**

1. **Member Stations (Top 5 Start Stations):**
   - Outer borough stations near residential areas
   - Brooklyn and Queens commuter hubs
   - Near subway connections

2. **Casual Rider Stations (Top 5):**
   - Manhattan tourist areas
   - Central Park entrances
   - Waterfront locations
   - Major attractions (Times Square area, Brooklyn Bridge)

3. **Spatial Concentration:**
   - Casual riders highly concentrated in Manhattan core
   - Members more dispersed across boroughs
   - Reflects different trip purposes

## Weather Impact Analysis

### Temperature Effects

**Key Findings:**

1. **Strong Positive Correlation:**
   - As temperature increases, ridership increases
   - Correlation coefficient: r = 0.68 (p < 0.001)
   - Relationship appears roughly linear in 60-85Â°F range

2. **Optimal Temperature Range:**
   - Peak ridership: 70-80Â°F
   - Below 60Â°F: Noticeable decline
   - Above 85Â°F: Slight decline (too hot?)

3. **Different Sensitivities by User Type:**
   - Casual riders more temperature-sensitive
   - Members show more consistent ridership across temperatures
   - Suggests members are "committed" riders (commuting)

**Visualization:**
```r
# Temperature vs. daily rides
daily_weather <- bike_data_clean %>%
  group_by(start_date, tmax) %>%
  summarize(total_rides = n())

ggplot(daily_weather, aes(x = tmax, y = total_rides)) +
  geom_point(size = 3, alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE, color = "blue") +
  labs(
    title = "Daily Ridership vs. Maximum Temperature",
    x = "Maximum Temperature (Â°F)",
    y = "Total Daily Rides"
  ) +
  theme_minimal()
```

### Precipitation Effects

**Key Findings:**

1. **Dramatic Impact:**
   - Rain significantly reduces ridership
   - Days with >0.5 inches precipitation: 30-40% fewer rides
   - Even light rain (<0.1 inches): 10-15% reduction

2. **Threshold Effects:**
   - 0-0.1 inches: Minimal impact
   - 0.1-0.5 inches: Moderate decline
   - Over 0.5 inches: Severe decline

3. **User Type Differences:**
   - Casual riders: Very sensitive to rain (50%+ decline)
   - Members: More resilient (20-30% decline)
   - Members still need to commute despite weather

### Combined Weather Factors

**Key Findings:**

1. **Interactive Effects:**
   - Warm + Dry = Maximum ridership
   - Cool + Rainy = Minimum ridership
   - Temperature matters more when dry
   - Rain matters regardless of temperature

2. **Weather "Threshold" for Cycling:**
   - Below 55Â°F + Rain: Very low ridership
   - Above 70Â°F + Dry: Very high ridership
   - Middle ranges show more variability

## Time Series Decomposition

**Key Findings:**

1. **Trend Component:**
   - Slight downward trend through September
   - Likely reflects cooling temperatures toward fall

2. **Seasonal Component:**
   - Strong 7-day weekly cycle
   - Reflects weekday vs. weekend patterns

3. **Residual Variation:**
   - Mostly explained by day-to-day weather variation
   - Some random noise remains

## Major Changes to Initial Ideas

Through EDA, several initial assumptions were challenged or refined:

1. **Initial Idea:** Weather would show moderate effects  
   **Revised:** Weather effects are strong and clearly quantifiable, especially precipitation

2. **Initial Idea:** Weekends would show similar total ridership  
   **Revised:** Weekends show 20-30% lower volume, despite longer individual trips

3. **Initial Idea:** User types differ mainly in volume  
   **Revised:** User types show fundamentally different behavioral patterns (commute vs. recreation)

4. **Initial Idea:** Simple linear models would suffice  
   **Revised:** Need separate models by user type to capture different sensitivities

5. **Initial Idea:** All Manhattan stations would be similar  
   **Revised:** Clear geographic stratification: tourist areas vs. residential commuter hubs

These insights motivated the statistical analyses and modeling approach described in the next section, where we formally test these relationships and quantify effect sizes.

</div>

---

# Statistical Analysis

<div class="info-card">

Building on insights from exploratory analysis, we conducted formal statistical analyses to quantify relationships and test hypotheses. This section describes our modeling approach, results, and interpretation.

## Analysis Objectives

1. Quantify the effects of temperature and precipitation on daily ridership
2. Assess day-of-week effects on ridership
3. Compare weather sensitivity between member and casual riders
4. Build predictive models for operational planning

## Data Preparation for Modeling

### Daily Aggregation

We aggregated trip-level data to the daily level for regression analysis:

```r
daily_analysis <- bike_data_clean %>%
  group_by(start_date, member_casual) %>%
  summarize(
    total_rides = n(),
    avg_duration = mean(ride_duration_min),
    avg_distance = mean(distance_km)
  ) %>%
  left_join(weather_clean, by = c("start_date" = "date")) %>%
  mutate(
    day_of_week = wday(start_date, label = TRUE),
    is_weekend = day_of_week %in% c("Sat", "Sun")
  )
```

**Final dataset for modeling:**
- **Unit of analysis:** Day Ã— User Type
- **Sample size:** 60 observations (30 days Ã— 2 user types)
- **Outcome variable:** Total rides per day
- **Predictors:** Temperature (Â°F), Precipitation (inches), Day of week

## Correlation Analysis

### Pearson Correlations

**Temperature and Ridership:**
- Total rides: r = 0.68, p < 0.001
- Member rides: r = 0.64, p < 0.001  
- Casual rides: r = 0.71, p < 0.001

**Interpretation:** Strong positive relationship between temperature and ridership across all user types, with casual riders showing slightly higher correlation.

**Precipitation and Ridership:**
- Total rides: r = -0.58, p < 0.001
- Member rides: r = -0.52, p < 0.001
- Casual rides: r = -0.65, p < 0.001

**Interpretation:** Strong negative relationship between precipitation and ridership, with casual riders again more sensitive.

### Spearman Correlations

Given the non-normal distribution of precipitation (many zero days), we also computed Spearman rank correlations:

- Temperature: Ï = 0.66 (similar to Pearson)
- Precipitation: Ï = -0.62 (stronger than Pearson)

**Interpretation:** Rank-based correlations confirm relationships are robust and not driven by outliers.

## ANOVA: Day of Week Effects

### Overall Day-of-Week Comparison

**Research Question:** Do different days of the week show significantly different ridership?

**Method:** One-way ANOVA with day of week as factor

**Results:**
```r
anova_result <- aov(total_rides ~ day_of_week, data = daily_analysis)
summary(anova_result)

# F(6, 53) = 8.43, p < 0.001
```

**Interpretation:** Highly significant day-of-week effect. At least one day differs significantly from others.

### Post-Hoc Comparisons (Tukey HSD)

**Key Findings:**
- Tuesday-Thursday significantly higher than Saturday-Sunday (p < 0.01)
- No significant differences among Tuesday, Wednesday, Thursday
- Monday intermediate between weekday and weekend levels
- Friday lower than mid-week but higher than weekend

**Practical Implication:** Weekday ridership ~25% higher than weekend, primarily driven by commuting.

## Multiple Regression Models

### Model 1: Total Daily Ridership

**Model Specification:**
```r
model_total <- lm(total_rides ~ tmax + prcp + is_weekend, 
                  data = daily_analysis %>% 
                    group_by(start_date) %>% 
                    summarize(total_rides = sum(total_rides),
                             tmax = first(tmax),
                             prcp = first(prcp),
                             is_weekend = first(is_weekend)))
```

**Results:**

| Predictor | Coefficient | Std. Error | t-value | p-value |
|-----------|-------------|------------|---------|---------|
| Intercept | -2,156 | 1,234 | -1.75 | 0.090 |
| Temperature (tmax) | 68.4 | 16.2 | 4.22 | <0.001 |
| Precipitation (prcp) | -1,840 | 420 | -4.38 | <0.001 |
| Weekend (vs. Weekday) | -876 | 285 | -3.07 | 0.004 |

**Model Fit:**
- RÂ² = 0.72
- Adjusted RÂ² = 0.69
- F(3, 26) = 22.3, p < 0.001

**Interpretation:**

1. **Temperature Effect:** Each 10Â°F increase in temperature associated with ~684 additional rides per day (p < 0.001)
   - Going from 60Â°F to 80Â°F: ~1,368 more rides

2. **Precipitation Effect:** Each inch of precipitation associated with ~1,840 fewer rides (p < 0.001)
   - A moderate rain day (0.5 inches): ~920 fewer rides

3. **Weekend Effect:** Weekends average 876 fewer rides than weekdays, controlling for weather (p = 0.004)

4. **Model Performance:** The model explains 72% of variance in daily ridership, indicating strong predictive power.

### Model 2: Member Ridership

**Model Specification:**
```r
model_member <- lm(total_rides ~ tmax + prcp + is_weekend,
                   data = daily_analysis %>% 
                     filter(member_casual == "member"))
```

**Results:**

| Predictor | Coefficient | Std. Error | t-value | p-value |
|-----------|-------------|------------|---------|---------|
| Intercept | -1,620 | 982 | -1.65 | 0.110 |
| Temperature (tmax) | 52.3 | 12.8 | 4.08 | <0.001 |
| Precipitation (prcp) | -1,230 | 335 | -3.67 | 0.001 |
| Weekend (vs. Weekday) | -720 | 228 | -3.16 | 0.004 |

**Model Fit:**
- RÂ² = 0.68
- Adjusted RÂ² = 0.64

**Key Findings for Members:**

1. **Temperature Sensitivity:** +523 rides per 10Â°F increase
   - Less sensitive than casual riders
   - Still highly significant effect

2. **Rain Resilience:** -1,230 rides per inch of precipitation
   - More resilient than casual riders
   - Many must commute regardless of weather

3. **Weekend Drop:** -720 rides on weekends
   - Clear commuting pattern
   - Weekend leisure not a major use case

### Model 3: Casual Ridership

**Model Specification:**
```r
model_casual <- lm(total_rides ~ tmax + prcp + is_weekend,
                   data = daily_analysis %>% 
                     filter(member_casual == "casual"))
```

**Results:**

| Predictor | Coefficient | Std. Error | t-value | p-value |
|-----------|-------------|------------|---------|---------|
| Intercept | -536 | 252 | -2.13 | 0.042 |
| Temperature (tmax) | 16.1 | 3.3 | 4.88 | <0.001 |
| Precipitation (prcp) | -610 | 85 | -7.18 | <0.001 |
| Weekend (vs. Weekday) | -156 | 58 | -2.69 | 0.012 |

**Model Fit:**
- RÂ² = 0.75
- Adjusted RÂ² = 0.72

**Key Findings for Casual Riders:**

1. **High Temperature Sensitivity:** +161 rides per 10Â°F increase
   - Recreational riders very responsive to nice weather
   - Strongest weather sensitivity of all groups

2. **Rain Avoidance:** -610 rides per inch of precipitation
   - Highly sensitive to rain
   - Discretionary trips easily canceled

3. **Weekend Preference:** -156 rides on weekends
   - Unexpected! Still lower than weekdays
   - May reflect tourist activity concentrated on weekdays in September

## Model Diagnostics

### Residual Analysis

**Normality:**
- Shapiro-Wilk tests: All p > 0.05
- Q-Q plots show approximate normality
- Minor deviations at tails, but acceptable

**Homoscedasticity:**
- Residuals vs. Fitted plots show no clear patterns
- Breusch-Pagan tests: All p > 0.05
- Constant variance assumption satisfied

**Independence:**
- Durbin-Watson tests: All near 2.0
- No evidence of temporal autocorrelation
- Independence assumption satisfied

**Multicollinearity:**
- VIF values all < 2.0
- No concerning collinearity
- Predictors are appropriately independent

### Outlier Analysis

**Cook's Distance:**
- All observations Cook's D < 0.5
- No influential outliers
- Model robust to individual observations

**Leverage:**
- All hat values < 3(k+1)/n threshold
- No high-leverage points unduly influencing results

### Model Validation

**Cross-Validation:**
```r
# 5-fold cross-validation
cv_results <- cv.lm(model_total, k = 5)
# RMSE: 428 rides
# MAE: 345 rides
# RÂ²: 0.68 (slightly lower than training RÂ²)
```

**Interpretation:** Model performs similarly on held-out data, suggesting good generalizability within September 2025.

## Key Statistical Findings

### Effect Size Summary

**Temperature Effects (per 10Â°F increase):**
- Total ridership: +684 rides/day
- Member ridership: +523 rides/day  
- Casual ridership: +161 rides/day

**Precipitation Effects (per inch):**
- Total ridership: -1,840 rides/day
- Member ridership: -1,230 rides/day
- Casual ridership: -610 rides/day

**Weekend Effects:**
- Total: -876 rides
- Members: -720 rides
- Casual: -156 rides

### Practical Significance

These effects are not only statistically significant but also practically meaningful:

1. **Operational Planning:** A 20Â°F temperature change could swing daily ridership by ~1,400 rides (20% of typical volume), requiring adjusted bike distribution.

2. **Revenue Implications:** Weather-driven ridership variation has direct revenue impacts for system operators.

3. **User Behavior:** Members show ~60% of temperature sensitivity and ~67% of rain sensitivity compared to casual riders, confirming different trip purposes.

### Model Comparison

**Which model performs best?**

Model | RÂ² | Adj. RÂ² | RMSE | Purpose
------|-----|---------|------|--------
Total | 0.72 | 0.69 | 485 | Overall planning
Member | 0.68 | 0.64 | 392 | Commuter focus
Casual | 0.75 | 0.72 | 93 | Tourist operations

**Interpretation:** The casual rider model actually fits best (highest RÂ²), suggesting their behavior is most predictable from weather and temporal factors. Member behavior has more unexplained variation, possibly due to factors we don't measure (e.g., remote work days, individual preferences).

</div>

---

# Discussion

<div class="info-card">

## Summary of Main Findings

Our analysis of 100,000 Citi Bike trips from September 2025, combined with daily weather data, revealed clear and quantifiable patterns in urban bike-share usage:

### 1. Temporal Rhythms Strongly Shape Ridership

**Commuter-Driven System:**
- Sharp weekday peaks at 8 AM and 6 PM aligned with typical NYC commute times
- Weekdays show 25% higher overall ridership than weekends
- Tuesday through Thursday represent peak usage days

**Weekend Recreational Pattern:**
- More spread-out usage throughout midday (10 AM - 4 PM)
- Longer individual trip durations (40-50% longer than weekday trips)
- No sharp peaks, consistent with leisure and tourism

**Implication:** Citi Bike serves primarily as a commuter transportation option, with secondary recreational use on weekends. This has important implications for station placement, dock capacity, and marketing strategies.

### 2. Distinct User Segments with Different Behaviors

**Members (75% of rides):**
- Strong weekday commuting pattern with sharp AM/PM peaks
- Shorter, more utilitarian trips (10-12 minutes average)
- More dispersed geographically across boroughs
- Less weather-sensitive (must commute regardless)
- Prefer classic bikes slightly (58%)

**Casual Riders (25% of rides):**
- More weekend/midday usage
- Longer exploration trips (15-18 minutes average)
- Concentrated in Manhattan tourist areas and landmarks
- Highly weather-sensitive (discretionary trips)
- Prefer electric bikes (52%)

**Implication:** These are fundamentally different user groups requiring different service strategies. Members need reliable commuter service with good coverage and speed. Casual riders want accessible bikes near tourist destinations with user-friendly (electric) options.

### 3. Weather Exerts Strong, Quantifiable Influence

**Temperature Effects:**
- Each 10Â°F increase â†’ ~684 additional daily rides
- Effect strongest for casual riders (+161 per 10Â°F)
- Optimal range: 70-80Â°F
- Below 60Â°F: Noticeable ridership decline

**Precipitation Effects:**
- Each inch of rain â†’ ~1,840 fewer daily rides  
- Even light rain (<0.1 in) â†’ 10-15% decline
- Heavy rain (>0.5 in) â†’ 30-40% decline
- Casual riders most affected (50%+ decline in rain)

**Combined Effects:**
- Weather explains ~72% of variance in daily ridership
- Warm + Dry = maximum ridership
- Cool + Rainy = minimum ridership
- Predictive models enable operational planning

**Implication:** Weather is not a minor inconvenience but a major determinant of system usage. Operators should plan for weather-driven demand fluctuations, and planners should consider covered stations or all-weather infrastructure to reduce weather sensitivity.

## Comparison to Expectations

### Expectations Confirmed

1. **Commuter Peaks:** We expected and found clear morning/evening peaks on weekdays, confirming Citi Bike's role in urban commuting.

2. **Weekend Patterns:** Lower weekend volume but longer trips confirmed our hypothesis about recreational vs. utilitarian use.

3. **Weather Effects:** We expected weather to matter and found strong, quantifiable effects that matched our hypotheses.

4. **User Differences:** Members vs. casual riders showed expected differences in trip purpose and behavior.

### Unexpected Findings

1. **Magnitude of Weather Effects:** The 72% RÂ² value was higher than expected, suggesting weather is even more important than anticipated.

2. **Casual Weekend Pattern:** We expected casual riders to show higher weekend volume, but they still rode more on weekdays (though the gap was smaller). This may reflect September tourism patterns or business travel.

3. **Electric Bike Adoption:** 45% electric bike usage was higher than expected, suggesting rapid adoption of e-bikes, especially among casual riders.

4. **Member Rain Resilience:** While members were less rain-sensitive, they still showed a 25-30% decline in heavy rainâ€”more than we expected for "committed" commuters.

5. **Geographic Concentration:** The extreme concentration of casual riders in specific tourist areas (Central Park, waterfront, Times Square) was starker than anticipated.

## Insights into Urban Mobility

### For Urban Planning

1. **Infrastructure Investment:** The strong commuter usage justifies continued investment in protected bike lanes, especially along major commuter corridors connecting outer boroughs to Manhattan.

2. **Station Placement:** Member behavior suggests need for stations near residential areas and transit hubs. Casual usage justifies tourist-area concentration.

3. **All-Weather Infrastructure:** Given weather's impact, covered stations, bike shelters, or all-season bike lanes could reduce weather sensitivity and increase overall usage.

4. **Integration with Transit:** The morning/evening peaks and station locations near subway stops suggest Citi Bike functions as a "first-mile/last-mile" solution complementing public transit.

### For Public Health

1. **Active Transportation:** The high weekday commuter usage (thousands of rides daily) represents significant physical activity, contributing to chronic disease prevention goals.

2. **Equity Considerations:** Member-dominated ridership in outer boroughs versus casual riders in tourist areas may reflect equity gaps in who benefits from bike-share.

3. **Weather Barriers:** Understanding weather sensitivity can inform interventions to promote year-round active transportation.

### For System Operations

1. **Demand Forecasting:** The predictive models (RÂ² = 0.72) enable accurate daily demand forecasting based on weather forecasts, improving bike redistribution and dock management.

2. **Capacity Planning:** Knowing peak hours (8 AM, 6 PM) and peak days (Tue-Thu) enables optimized staffing and redistribution.

3. **Marketing:** Weather patterns suggest opportunities for rain-day promotions or incentives to smooth demand.

4. **Fleet Management:** The 45% electric bike usage suggests need for continued e-bike investment and charging infrastructure.

### For Environmental Sustainability

1. **Car Trip Replacement:** High commuter usage suggests Citi Bike is displacing car trips, reducing emissions and congestion.

2. **Weather Resilience:** The system's weather sensitivity highlights a barrier to year-round sustainable transportation adoption.

3. **Tourism Impact:** High casual rider usage in tourist areas may be displacing taxi/rideshare trips, contributing to cleaner tourism.

## Strengths of the Analysis

1. **Rich Dataset:** 100,000 rides provide robust statistical power while remaining computationally manageable.

2. **Stratified Sampling:** Our proportional sampling approach preserved the temporal and weather-related patterns of the full dataset.

3. **Multiple Methods:** Combining visualization, correlation, ANOVA, and regression provided comprehensive insights.

4. **User Segmentation:** Separate analyses by user type revealed fundamentally different behaviors that would be masked in overall analyses.

5. **Practical Application:** Findings directly inform operational decisions and policy recommendations.

6. **Reproducibility:** All code, data, and methods documented for transparency and reproducibility.

## Limitations

### Temporal Scope

**Single Month Analysis:**
- Our analysis covers only September 2025
- Cannot assess seasonal patterns (winter, spring, summer variations)
- Cannot identify year-over-year trends or growth patterns

**Missing Holidays:**
- September includes Labor Day but no major holidays beyond that
- Holiday effects not fully characterized

**Future Work:** Extend analysis to full year to understand seasonal patterns and holiday effects.

### Geographic Scope

**NYC-Specific:**
- Findings may not generalize to other cities with different climates, urban forms, or bike cultures
- NYC has unique characteristics (dense core, extensive transit, diverse boroughs)

**Station Coverage:**
- Citi Bike doesn't cover all NYC neighborhoods
- Findings reflect areas with service, not all potential demand

**Future Work:** Comparative analysis across multiple cities to identify universal patterns vs. local effects.

### Weather Variables

**Limited Weather Metrics:**
- Only temperature and precipitation included
- Missing: Wind speed, humidity, air quality, "feels like" temperature
- Missing: Weather forecasts vs. actual conditions

**Single Weather Station:**
- Central Park data may not reflect conditions in all boroughs
- Microclimates not captured

**Future Work:** Incorporate additional weather variables and multiple weather stations.

### Causal Inference Limitations

**Observational Data:**
- Cannot definitively establish causation (weather â†’ ridership)
- Possible confounding (e.g., special events, news, air quality)
- Cannot test interventions experimentally

**Future Work:** Natural experiments (e.g., sudden weather changes) or instrumental variables could strengthen causal claims.

### User-Level Variables

**No Individual Demographics:**
- Cannot assess age, income, race, gender effects
- Cannot identify individual behavior patterns across trips
- Cannot assess equity in access and usage

**No Trip Purpose:**
- We infer commute vs. recreation from patterns, but lack direct data
- Cannot verify assumptions about trip motivation

**Future Work:** Survey data or user-level demographics (where privacy-appropriate) would enable equity analyses and better understanding of barriers to adoption.

### Model Limitations

**Linear Assumptions:**
- We assume linear relationships (e.g., each degree has constant effect)
- Reality may have thresholds or non-linear effects

**Omitted Variables:**
- Models don't include: Gas prices, transit delays, bike availability at specific stations, marketing campaigns, COVID-19 impacts
- Residual variance likely includes these unmeasured factors

**Temporal Dependence:**
- We assume independence across days
- Possible serial correlation if weather patterns persist

**Future Work:** Non-linear models (GAMs, polynomial regression), time series models, or additional data sources could improve predictions.

### Generalizability

**Sample vs. Population:**
- While our stratified sample preserves key patterns, it's still a sample
- Results apply to September 2025, not necessarily other months/years

**Service Changes:**
- Citi Bike continuously adds stations and bikes
- Patterns may shift as service area expands

**External Validity:**
- Findings from September 2025 may not apply to post-pandemic "new normal" or future years as remote work evolves

## Future Directions

### Extensions of Current Analysis

1. **Full-Year Analysis:** Extend to all months to understand winter vs. summer patterns

2. **Multi-Year Trends:** Analyze 2020-2025 to understand pandemic impacts and recovery

3. **Borough-Specific Models:** Separate models for Manhattan, Brooklyn, Queens, Bronx

4. **Station-Level Analysis:** Model demand at individual stations for micro-level operations

5. **Trip Flow Networks:** Network analysis of popular routes and connections

### New Research Questions

1. **Equity Analysis:** Who has access to Citi Bike? How does usage vary by neighborhood income, race, age?

2. **Modal Substitution:** What trips does Citi Bike replace? (Car, taxi, transit, walking?)

3. **Health Impacts:** Can we quantify health benefits from increased active transportation?

4. **COVID-19 Impacts:** How did the pandemic permanently change bike-share usage patterns?

5. **Pricing Experiments:** How does pricing affect usage patterns and equity?

6. **E-Bike Effects:** Do electric bikes change who rides and how far they go?

### Methodological Improvements

1. **Machine Learning:** Random forests, gradient boosting for improved predictions

2. **Spatial Models:** Incorporate spatial autocorrelation and geographic clusters

3. **Time Series Forecasting:** ARIMA, Prophet, or LSTM models for operational forecasting

4. **Causal Inference:** Instrumental variables, difference-in-differences, or natural experiments

5. **User Surveys:** Primary data collection to understand motivations and barriers

## Conclusion

This analysis demonstrates that NYC Citi Bike ridership is highly predictable from temporal patterns and weather conditions. The system serves primarily as commuter transportation during weekdays, with secondary recreational use on weekends. Member and casual riders represent fundamentally different user groups with distinct behaviors and weather sensitivities.

Weatherâ€”particularly temperature and precipitationâ€”exerts strong, quantifiable effects on ridership, explaining 72% of day-to-day variation. These effects are actionable: operators can use weather forecasts to predict demand, adjust bike distribution, and optimize operations.

The findings have implications beyond bike-share operations. They inform urban planning decisions about bike infrastructure investment, public health initiatives to promote active transportation, and environmental sustainability efforts to reduce car dependence. Understanding what drives people to choose cyclingâ€”and what barriers prevent themâ€”is essential for creating more livable, sustainable cities.

As bike-share systems continue to grow and evolve, data-driven analysis will become increasingly important for operations, planning, and policy. This project demonstrates the value of combining rich trip-level data with external factors like weather to generate actionable insights. Future research can build on this foundation to address equity concerns, assess long-term trends, and optimize bike-share systems for diverse users and communities.

**The pulse of the city, it turns out, beats fastest when the sun shines and the rain stays away.**

</div>

<br>

---

<div class="highlight-box">

## Project Links & Resources

**Live Website:** [https://lovenza.github.io/citibike_ny.github.io/](https://lovenza.github.io/citibike_ny.github.io/)

**GitHub Repository:** [https://github.com/lovenza/citibike_ny.github.io](https://github.com/lovenza/citibike_ny.github.io)

**Interactive Dashboard:** [https://kwokmungyu.shinyapps.io/shiny_app/](https://kwokmungyu.shinyapps.io/shiny_app/)

**Data Sources:**
- Citi Bike System Data: [https://citibikenyc.com/system-data](https://citibikenyc.com/system-data)
- NOAA Weather Data: [https://www.ncdc.noaa.gov/cdo-web/](https://www.ncdc.noaa.gov/cdo-web/)

**Course:** P8105 Data Science I, Columbia University Mailman School of Public Health

</div>

<br>

<a href="index.html" class="back-home">
  <i class="fa fa-home"></i> Back to Home
</a>
